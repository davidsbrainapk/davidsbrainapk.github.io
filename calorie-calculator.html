<div style="max-width: 600px; margin: auto; background-color: #1e1e1e; color: #ffffff; padding: 2rem; border-radius: 1rem; font-family: sans-serif;">
  <h2 style="text-align: center;">Daily Calorie & Macro Calculator</h2>
  <form id="macroCalc">
    <label>Units:<br>
      <select id="unitToggle">
        <option value="metric">Metric (kg / cm)</option>
        <option value="imperial">Imperial (lb / in)</option>
      </select>
    </label><br><br>
    <label>Age:<br><input type="number" name="age" required></label><br><br>
    <label>Sex:<br>
      <select name="sex">
        <option value="male">Male</option>
        <option value="female">Female</option>
      </select>
    </label><br><br>
    <label id="heightLabel">Height (cm):<br><input type="number" name="height" required></label><br><br>
    <label id="weightLabel">Weight (kg):<br><input type="number" name="weight" required></label><br><br>
    <label>Activity Level:<br>
      <select name="activity">
        <option value="1.2">Sedentary</option>
        <option value="1.375">Light</option>
        <option value="1.55">Moderate</option>
        <option value="1.725">Very Active</option>
        <option value="1.9">Athlete/Hardcore</option>
      </select>
    </label><br><br>
    <label>Goal:<br>
      <select name="goal">
        <option value="fat">Fat Loss</option>
        <option value="maintain">Maintenance</option>
        <option value="muscle">Muscle Gain</option>
      </select>
    </label><br><br>
    <button type="submit" style="width: 100%; padding: 0.5rem; background-color: #e63946; border: none; color: white; font-weight: bold; border-radius: 0.5rem;">Calculate</button>
  </form>

  <div id="results" style="margin-top: 2rem; display: none; border-top: 1px solid #444; padding-top: 1rem;">
    <h3>Results:</h3>
    <p><strong>TDEE:</strong> <span id="tdee"></span> kcal/day</p>
    <p><strong>Target Calories:</strong> <span id="targetCals"></span> kcal/day</p>
    <p><strong>Macros:</strong></p>
    <ul>
      <li><strong>Protein:</strong> <span id="protein"></span> g</li>
      <li><strong>Carbs:</strong> <span id="carbs"></span> g</li>
      <li><strong>Fats:</strong> <span id="fats"></span> g</li>
    </ul>
    <p style="font-size: 0.8rem; color: #888">Powered by davidsbrain.apk ðŸ§ </p>
  </div>
</div>

<script>
  const unitToggle = document.getElementById('unitToggle');
  const heightLabel = document.getElementById('heightLabel');
  const weightLabel = document.getElementById('weightLabel');

  unitToggle.addEventListener('change', () => {
    const unit = unitToggle.value;
    heightLabel.innerHTML = unit === 'metric'
      ? 'Height (cm):<br><input type="number" name="height" required>'
      : 'Height (in):<br><input type="number" name="height" required>';
    weightLabel.innerHTML = unit === 'metric'
      ? 'Weight (kg):<br><input type="number" name="weight" required>'
      : 'Weight (lb):<br><input type="number" name="weight" required>';
  });

  document.getElementById('macroCalc').addEventListener('submit', function(e) {
    e.preventDefault();
    const form = new FormData(e.target);
    const age = +form.get('age');
    const sex = form.get('sex');
    let height = +form.get('height');
    let weight = +form.get('weight');
    const activity = +form.get('activity');
    const goal = form.get('goal');
    const unit = unitToggle.value;

    // Convert imperial to metric if needed
    if (unit === 'imperial') {
      weight = weight * 0.453592;
      height = height * 2.54;
    }

    let bmr = sex === 'male'
      ? (10 * weight) + (6.25 * height) - (5 * age) + 5
      : (10 * weight) + (6.25 * height) - (5 * age) - 161;

    const tdee = Math.round(bmr * activity);
    let target = tdee;
    let split;

    if (goal === 'fat') {
      target -= 500;
      split = { p: 0.4, c: 0.35, f: 0.25 };
    } else if (goal === 'muscle') {
      target += 300;
      split = { p: 0.3, c: 0.5, f: 0.2 };
    } else {
      split = { p: 0.3, c: 0.4, f: 0.3 };
    }

    const protein = Math.round((target * split.p) / 4);
    const carbs = Math.round((target * split.c) / 4);
    const fats = Math.round((target * split.f) / 9);

    document.getElementById('tdee').textContent = tdee;
    document.getElementById('targetCals').textContent = target;
    document.getElementById('protein').textContent = protein;
    document.getElementById('carbs').textContent = carbs;
    document.getElementById('fats').textContent = fats;

    document.getElementById('results').style.display = 'block';
  });
</script>
