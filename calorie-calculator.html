<div style="max-width: 600px; margin: auto; background-color: #1e1e1e; color: #ffffff; padding: 2rem; border-radius: 1rem; font-family: sans-serif;">
  <h2 style="text-align: center;">ðŸ”¥ Daily Calorie & Macro Calculator</h2>
  <form id="macroCalc">
    
    <label>Units:<br>
      <select id="unitToggle">
        <option value="imperial">Imperial (lb / ft+in)</option>
        <option value="metric">Metric (kg / cm)</option>
      </select>
    </label><br><br>
    <label>Age:<br>
  <select name="age" required>
    <option value="">Select Age</option>
    <option value="18">18</option>
    <option value="19">19</option>
    <option value="20">20</option>
    <option value="21">21</option>
    <option value="22">22</option>
    <option value="23">23</option>
    <option value="24">24</option>
    <option value="25">25</option>
    <option value="26">26</option>
    <option value="27">27</option>
    <option value="28">28</option>
    <option value="29">29</option>
    <option value="30">30</option>
    <option value="31">31</option>
    <option value="32">32</option>
    <option value="33">33</option>
    <option value="34">34</option>
    <option value="35">35</option>
    <option value="36">36</option>
    <option value="37">37</option>
    <option value="38">38</option>
    <option value="39">39</option>
    <option value="40">40</option>
    <option value="41">41</option>
    <option value="42">42</option>
    <option value="43">43</option>
    <option value="44">44</option>
    <option value="45">45</option>
    <option value="46">46</option>
    <option value="47">47</option>
    <option value="48">48</option>
    <option value="49">49</option>
    <option value="50">50</option>
    <option value="51">51</option>
    <option value="52">52</option>
    <option value="53">53</option>
    <option value="54">54</option>
    <option value="55">55</option>
    <option value="56">56</option>
    <option value="57">57</option>
    <option value="58">58</option>
    <option value="59">59</option>
    <option value="60">60</option>
    <option value="61">61</option>
    <option value="62">62</option>
    <option value="63">63</option>
    <option value="64">64</option>
    <option value="65">65</option>
    <option value="66">66</option>
    <option value="67">67</option>
    <option value="68">68</option>
    <option value="69">69</option>
    <option value="70">70</option>
    <option value="71">71</option>
    <option value="72">72</option>
    <option value="73">73</option>
    <option value="74">74</option>
    <option value="75">75</option>
    <option value="76">76</option>
    <option value="77">77</option>
    <option value="78">78</option>
    <option value="79">79</option>
    <option value="80">80</option>
    <option value="81">81</option>
    <option value="82">82</option>
    <option value="83">83</option>
    <option value="84">84</option>
    <option value="85">85</option>
    <option value="86">86</option>
    <option value="87">87</option>
    <option value="88">88</option>
    <option value="89">89</option>
    <option value="90">90</option>
    <option value="91">91</option>
    <option value="92">92</option>
    <option value="93">93</option>
    <option value="94">94</option>
    <option value="95">95</option>
    <option value="96">96</option>
    <option value="97">97</option>
    <option value="98">98</option>
    <option value="99">99</option>
    <option value="100">100</option>
  </select>
</label>
</label><br><br>
    <label>Sex:<br>
      <select name="sex">
        <option value="male">Male</option>
        <option value="female">Female</option>
      </select>
    </label><br><br>
    <div id="heightLabel"></div><br>
    <label id="weightLabel">Weight (lb):<br><input type="number" name="weight" required></label><br><br>
    <label>Activity Level:<br>
      <select name="activity">
  <option value="1.2">Sedentary â€“ little to no exercise</option>
  <option value="1.375">Light â€“ light activity 1â€“3 days/week</option>
  <option value="1.55">Moderate â€“ moderate activity 3â€“5 days/week</option>
  <option value="1.725">Very Active â€“ hard training 6â€“7 days/week</option>
  <option value="1.9">Athlete/Hardcore â€“ twice daily training or physical job</option>
</select>
    </label><br><br>
    <label>Goal:<br>
  <select name="goal">
    <option value="fat">Fat Loss â€“ Creates a 500 Calorie deficit for weight loss</option>
    <option value="maintain">Maintenance â€“ Keeps calories at your TDEE for weight stability</option>
    <option value="muscle">Muscle Gain â€“ Adds 300 Calorie surplus to support muscle growth</option>
  </select>
</label>
</label>
    </label><br><br>    

<div id="macroGrams">
  <label>Protein (g):<br>
    <input type="number" name="proteinGrams" placeholder="e.g. 180">
    <small style="color:#aaa">A good starting point is 0.8â€“1g per pound of bodyweight.</small>
  </label><br><br>
  <label>Carbs (g):<br>
    <input type="number" name="carbGrams" placeholder="optional">
  </label><br><br>
  <label>Fats (g):<br>
    <input type="number" name="fatGrams" placeholder="optional">
  </label><br><br>
</div>

<label>Meals Per Day:<br>
      <select name="meals">
        <option value="2">2</option>
        <option value="3" selected>3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
      </select>
    </label><br><br>

    <button type="submit" style="width: 100%; padding: 0.5rem; background-color: #e63946; border: none; color: white; font-weight: bold; border-radius: 0.5rem;">Calculate</button>
  </form>

  <div id="results" style="margin-top: 2rem; display: none; border-top: 1px solid #444; padding-top: 1rem;">
    <h3>Results:</h3>
<p style="font-size: 0.9rem; color: #aaa; margin-bottom: 1rem;">
  <strong>TDEE</strong> (Total Daily Energy Expenditure) is the number of calories your body needs per day to maintain your current weight â€” based on your activity level, age, sex, height, and weight.
</p>
    <p><strong>TDEE:</strong> <span id="tdee"></span> Calories/day</p>
    <p><strong>Target Calories:</strong> <span id="targetCals"></span> Calories/day</p>
    <div style="margin-top: 1rem;">
      <label>Macros:</label>
      <div style="height: 1rem; background: #444; border-radius: 0.5rem; overflow: hidden; display: flex;">
        <div id="bar-protein" style="height: 100%; background: #ff4d4d;"></div>
        <div id="bar-carbs" style="height: 100%; background: #ffc300;"></div>
        <div id="bar-fats" style="height: 100%; background: #6bc1ff;"></div>
      </div>
    </div>
    <ul>
      <li><strong>Protein:</strong> <span id="protein"></span> g</li>
      <li><strong>Carbs:</strong> <span id="carbs"></span> g</li>
      <li><strong>Fats:</strong> <span id="fats"></span> g</li>
    </ul>
    <p><strong>Per Meal (<span id="mealCount"></span> meals/day):</strong></p>
    <ul>
      <li><span id="mealCals"></span> Calories/meal</li>
      <li><span id="mealProtein"></span> g protein</li>
      <li><span id="mealCarbs"></span> g carbs</li>
      <li><span id="mealFats"></span> g fats</li>
    </ul>
    <p style="font-size: 0.8rem; color: #888">Powered by davidsbrain.apk ðŸ§  â€“ <a href="mailto:davidsbrainapk@pm.me" style="color: #6bc1ff">Message me here</a></p>
  </div>
</div>

<script>
  const unitToggle = document.getElementById('unitToggle');
  const heightLabel = document.getElementById('heightLabel');
  const weightLabel = document.getElementById('weightLabel');

  function updateHeightFields(unit) {
    if (unit === 'imperial') {
      heightLabel.innerHTML = `Height:<br>
        <input type="number" name="feet" placeholder="Feet" required style="width: 45%;"> 
        <input type="number" name="inches" placeholder="Inches" required style="width: 45%;">`;
      weightLabel.innerHTML = 'Weight (lb):<br><input type="number" name="weight" required>';
    } 
  }

  updateHeightFields(unitToggle.value);

  
  unitToggle.addEventListener('change', () => updateHeightFields(unitToggle.value));

  document.getElementById('macroCalc').addEventListener('submit', function(e) {
    e.preventDefault();
    const form = new FormData(e.target);
    const age = +form.get('age');
    const sex = form.get('sex');
    const activity = +form.get('activity');
    const goal = form.get('goal');
    const meals = +form.get('meals');
    const macroMode = 'grams'; // input mode forced to grams
    const unit = unitToggle.value;
    let height, weight;

    if (unit === 'imperial') {
      const feet = +form.get('feet');
      const inches = +form.get('inches');
      height = ((feet * 12) + inches) * 2.54;
      weight = +form.get('weight') * 0.453592;
    } else {
      height = +form.get('height');
      weight = +form.get('weight');
    }

    const bmr = sex === 'male'
      ? (10 * weight) + (6.25 * height) - (5 * age) + 5
      : (10 * weight) + (6.25 * height) - (5 * age) - 161;

    const tdee = Math.round(bmr * activity);
    let target = tdee;
    if (goal === 'fat') target -= 500;
    else if (goal === 'muscle') target += 300;

    let split;

    if (macroMode === 'grams') {
      const pG = +form.get('proteinGrams') || 0;
      const cG = +form.get('carbGrams') || 0;
      const fG = +form.get('fatGrams') || 0;
      const fixedCals = (pG * 4) + (cG * 4) + (fG * 9);
      const remaining = target - fixedCals;
      const unset = [!form.get('proteinGrams'), !form.get('carbGrams'), !form.get('fatGrams')].filter(Boolean).length;

      let p = pG, c = cG, f = fG;
      if (unset > 0 && remaining > 0) {
        const per = remaining / unset;
        if (!form.get('proteinGrams')) p = Math.round(per / 4);
        if (!form.get('carbGrams')) c = Math.round(per / 4);
        if (!form.get('fatGrams')) f = Math.round(per / 9);
      }
      split = { p: (p * 4) / target, c: (c * 4) / target, f: (f * 9) / target };
    } else {
      const proteinSplit = +form.get('proteinSplit') / 100;
      const carbSplit = +form.get('carbSplit') / 100;
      const fatSplit = +form.get('fatSplit') / 100;
      split = { p: proteinSplit, c: carbSplit, f: fatSplit };
    }

    const protein = Math.round((target * split.p) / 4);
    const carbs = Math.round((target * split.c) / 4);
    const fats = Math.round((target * split.f) / 9);

    document.getElementById('tdee').textContent = tdee;
    document.getElementById('targetCals').textContent = target;
    document.getElementById('protein').textContent = protein;
    document.getElementById('carbs').textContent = carbs;
    document.getElementById('fats').textContent = fats;

    const total = split.p + split.c + split.f;
    document.getElementById('bar-protein').style.width = (split.p / total * 100) + '%';
    document.getElementById('bar-carbs').style.width = (split.c / total * 100) + '%';
    document.getElementById('bar-fats').style.width = (split.f / total * 100) + '%';

    document.getElementById('mealCals').textContent = Math.round(target / meals);
    document.getElementById('mealProtein').textContent = Math.round(protein / meals);
    document.getElementById('mealCarbs').textContent = Math.round(carbs / meals);
    document.getElementById('mealFats').textContent = Math.round(fats / meals);
    document.getElementById('mealCount').textContent = meals;

    document.getElementById('results').style.display = 'block';
  });
</script>

